#!/bin/bash

AITALK_PATH="$HOME/Desktop/linuxProjectAItalk/aitalk.py"

# Dependency checks
if ! command -v python3 >/dev/null 2>&1; then
    echo "❌ python3 not found in PATH."
    exit 1
fi

if ! command -v ollama >/dev/null 2>&1; then
    echo "❌ ollama not found in PATH."
    exit 1
fi

# --create-project
if [[ "$1" == "--create-project" ]]; then
    shift
    python3 "$AITALK_PATH" --create-project "$@"

# --explain-X (where X can be any number)
elif [[ "$1" =~ --explain-[0-9]+$ ]]; then
    python3 "$AITALK_PATH" "$1" --model llama3:8b

# --summarise "<prompt>" file.txt
elif [[ "$1" == "--summarise" ]]; then
    PROMPT="$2"
    FILE="$3"

    if [[ -z "$PROMPT" || -z "$FILE" ]]; then
        echo "❌ Usage: aitalk --summarise \"<prompt>\" <file>"
        exit 1
    fi

    if [[ ! -f "$FILE" ]]; then
        echo "❌ File not found: $FILE"
        exit 1
    fi

    python3 "$AITALK_PATH" --summarise "$PROMPT" "$FILE"

# Help
elif [[ "$1" == "--help" ]]; then
    echo "Usage:"
    echo "  aitalk --create-project \"make a react app\""
    echo "  aitalk --explain-5"
    echo "  aitalk --summarise \"summarise this file\" file.txt"
    exit 0

# Fallback
else
    echo "❌ Invalid usage."
    echo "Run: aitalk --help"
    exit 1
fi